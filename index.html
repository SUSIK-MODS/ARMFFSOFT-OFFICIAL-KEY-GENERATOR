<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ARMFFSOFT - –õ–∏—Ü–µ–Ω–∑–∏–æ–Ω–Ω—ã–µ –∫–ª—é—á–∏ | mypdftools.site</title>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-auth-compat.js"></script>
    
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        body { 
            background: linear-gradient(135deg, #0c2461, #1e3799, #4a69bd);
            color: white; 
            min-height: 100vh;
            padding: 20px;
        }
        .container { max-width: 1200px; margin: 0 auto; }
        
        .brand-header { 
            background: rgba(255,255,255,0.1);
            padding: 40px;
            border-radius: 20px;
            margin-bottom: 30px;
            text-align: center;
            border: 2px solid #e74c3c;
        }
        .brand-title { 
            font-size: 3em; 
            margin-bottom: 10px;
            background: linear-gradient(45deg, #e74c3c, #f39c12);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .auth-panel {
            background: rgba(255,255,255,0.08);
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .role-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin: 20px 0;
        }
        
        .btn {
            background: linear-gradient(45deg, #e74c3c, #c0392b);
            border: none;
            padding: 12px 25px;
            color: white;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        .btn-vip {
            background: linear-gradient(45deg, #f39c12, #e67e22);
        }
        .btn-user {
            background: linear-gradient(45deg, #3498db, #2980b9);
        }
        
        .login-form {
            background: rgba(255,255,255,0.05);
            padding: 20px;
            border-radius: 10px;
            margin: 15px 0;
            display: none;
        }
        
        .form-input { 
            width: 100%; 
            padding: 12px 15px;
            margin: 10px 0;
            border: none;
            border-radius: 8px;
            background: rgba(255,255,255,0.1);
            color: white;
            border: 1px solid rgba(255,255,255,0.3);
        }
        
        .user-panel, .admin-panel {
            display: none;
        }
        
        .vip-badge {
            background: linear-gradient(45deg, #f39c12, #e67e22);
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9em;
            margin-left: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="brand-header">
            <h1 class="brand-title">üîë ARMFFSOFT KEYS</h1>
            <p>–û—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ª–∏—Ü–µ–Ω–∑–∏—è–º–∏</p>
            <div class="domain-badge">mypdftools.site</div>
        </header>

        <!-- –ü–∞–Ω–µ–ª—å –≤—ã–±–æ—Ä–∞ —Ä–æ–ª–∏ -->
        <div class="auth-panel" id="roleSelection">
            <h3>–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –∞–∫–∫–∞—É–Ω—Ç–∞:</h3>
            <div class="role-buttons">
                <button class="btn btn-vip" onclick="showLoginForm('admin')">üëë VIP –ê–î–ú–ò–ù</button>
                <button class="btn btn-user" onclick="showLoginForm('user')">üë§ –û–ë–´–ß–ù–´–ô –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–¨</button>
            </div>
        </div>

        <!-- –§–æ—Ä–º–∞ –≤—Ö–æ–¥–∞ –¥–ª—è –ê–¥–º–∏–Ω–∞ -->
        <div class="login-form" id="adminLoginForm">
            <h3>üëë –í—Ö–æ–¥ –¥–ª—è –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</h3>
            <input type="email" id="adminEmail" class="form-input" placeholder="VIP Email" value="admin@armffsoft.com">
            <input type="password" id="adminPassword" class="form-input" placeholder="VIP –ü–∞—Ä–æ–ª—å" value="armffsoft2024">
            <button class="btn btn-vip" onclick="loginAdmin()">üöÄ –í–æ–π—Ç–∏ –∫–∞–∫ –ê–¥–º–∏–Ω</button>
        </div>

        <!-- –§–æ—Ä–º–∞ –≤—Ö–æ–¥–∞ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è -->
        <div class="login-form" id="userLoginForm">
            <h3>üë§ –í—Ö–æ–¥ –¥–ª—è –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h3>
            <input type="email" id="userEmail" class="form-input" placeholder="–í–∞—à email">
            <input type="password" id="userPassword" class="form-input" placeholder="–í–∞—à –ø–∞—Ä–æ–ª—å">
            <button class="btn btn-user" onclick="loginUser()">–í–æ–π—Ç–∏</button>
            <button class="btn" onclick="showRegisterForm()">üìù –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
        </div>

        <!-- –§–æ—Ä–º–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ -->
        <div class="login-form" id="registerForm">
            <h3>üìù –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h3>
            <input type="text" id="regName" class="form-input" placeholder="–í–∞—à–µ –∏–º—è">
            <input type="email" id="regEmail" class="form-input" placeholder="Email">
            <input type="password" id="regPassword" class="form-input" placeholder="–ü–∞—Ä–æ–ª—å">
            <input type="text" id="regTelegram" class="form-input" placeholder="Telegram (@username)">
            <button class="btn" onclick="registerUser()">‚úÖ –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
        </div>

        <!-- –ü–∞–Ω–µ–ª—å –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ -->
        <div class="admin-panel" id="adminPanel">
            <div style="text-align: center; margin-bottom: 20px;">
                <h2>üëë –ü–ê–ù–ï–õ–¨ –ê–î–ú–ò–ù–ò–°–¢–†–ê–¢–û–†–ê <span class="vip-badge">VIP</span></h2>
                <button class="btn" onclick="logout()">üö™ –í—ã–π—Ç–∏</button>
            </div>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                <div style="background: rgba(255,255,255,0.08); padding: 20px; border-radius: 10px;">
                    <h3>üé´ –°–æ–∑–¥–∞—Ç—å –ª–∏—Ü–µ–Ω–∑–∏—é</h3>
                    <input type="text" id="userName" class="form-input" placeholder="–ò–º—è –∫–ª–∏–µ–Ω—Ç–∞">
                    <input type="email" id="userEmail" class="form-input" placeholder="Email –∫–ª–∏–µ–Ω—Ç–∞">
                    <input type="text" id="userTelegram" class="form-input" placeholder="Telegram">
                    <select id="daysValid" class="form-input">
                        <option value="7">7 –¥–Ω–µ–π</option>
                        <option value="30" selected>30 –¥–Ω–µ–π</option>
                        <option value="90">90 –¥–Ω–µ–π</option>
                        <option value="365">1 –≥–æ–¥</option>
                    </select>
                    <button class="btn btn-vip" onclick="generateUserKey()">–°–æ–∑–¥–∞—Ç—å –ª–∏—Ü–µ–Ω–∑–∏—é</button>
                </div>

                <div style="background: rgba(255,255,255,0.08); padding: 20px; border-radius: 10px;">
                    <h3>üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–ª—é—á–∞</h3>
                    <input type="text" id="checkKeyInput" class="form-input" placeholder="–ö–ª—é—á –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏">
                    <button class="btn" onclick="checkKey()">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å</button>
                    <div id="checkResult" style="margin-top: 15px;"></div>
                </div>
            </div>

            <div id="keyResult" style="background: rgba(0,0,0,0.3); border: 2px solid #27ae60; border-radius: 10px; padding: 20px; margin: 20px 0; display: none;">
                <h3>‚úÖ –õ–∏—Ü–µ–Ω–∑–∏—è —Å–æ–∑–¥–∞–Ω–∞!</h3>
                <div style="font-size: 1.5em; color: #27ae60; margin: 10px 0;" id="generatedKey"></div>
                <div id="keyDetails"></div>
                <button class="btn" onclick="copyKey()">üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–ª—é—á</button>
            </div>

            <div style="background: rgba(255,255,255,0.08); padding: 20px; border-radius: 10px;">
                <h3>üìä –í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</h3>
                <div id="usersList" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 15px; margin-top: 15px;"></div>
            </div>
        </div>

        <!-- –ü–∞–Ω–µ–ª—å –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è -->
        <div class="user-panel" id="userPanel">
            <div style="text-align: center; margin-bottom: 20px;">
                <h2>üë§ –õ–ò–ß–ù–´–ô –ö–ê–ë–ò–ù–ï–¢</h2>
                <button class="btn" onclick="logout()">üö™ –í—ã–π—Ç–∏</button>
            </div>

            <div style="background: rgba(255,255,255,0.08); padding: 20px; border-radius: 10px; text-align: center;">
                <h3>üîë –í–∞—à–∏ –ª–∏—Ü–µ–Ω–∑–∏–∏</h3>
                <div id="userLicenses"></div>
            </div>
        </div>
    </div>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyAOPcJlGZs_K88PoS2G8PW8eir-kD_LzYE",
            authDomain: "armffsoft-keys.firebaseapp.com",
            projectId: "armffsoft-keys",
            storageBucket: "armffsoft-keys.firebasestorage.app",
            messagingSenderId: "577466829018",
            appId: "1:577466829018:web:cda9e4d2f673204dcbfde3"
        };

        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        const auth = firebase.auth();

        // VIP –ê–¥–º–∏–Ω –∞–∫–∫–∞—É–Ω—Ç
        const VIP_ADMIN = {
            email: "admin@armffsoft.com",
            password: "armffsoft2024"
        };

        function showLoginForm(role) {
            document.getElementById('roleSelection').style.display = 'none';
            if (role === 'admin') {
                document.getElementById('adminLoginForm').style.display = 'block';
            } else {
                document.getElementById('userLoginForm').style.display = 'block';
            }
        }

        function showRegisterForm() {
            document.getElementById('userLoginForm').style.display = 'none';
            document.getElementById('registerForm').style.display = 'block';
        }

        function loginAdmin() {
            const email = document.getElementById('adminEmail').value;
            const password = document.getElementById('adminPassword').value;

            if (email === VIP_ADMIN.email && password === VIP_ADMIN.password) {
                document.getElementById('adminLoginForm').style.display = 'none';
                document.getElementById('adminPanel').style.display = 'block';
                loadUsers();
                alert('–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä! üëë');
            } else {
                alert('–ù–µ–≤–µ—Ä–Ω—ã–µ VIP –¥–∞–Ω–Ω—ã–µ!');
            }
        }

        async function registerUser() {
            const email = document.getElementById('regEmail').value;
            const password = document.getElementById('regPassword').value;
            const name = document.getElementById('regName').value;
            const telegram = document.getElementById('regTelegram').value;

            try {
                const userCredential = await auth.createUserWithEmailAndPassword(email, password);
                await db.collection("users").doc(userCredential.user.uid).set({
                    name: name,
                    email: email,
                    telegram: telegram,
                    role: "user",
                    createdAt: new Date()
                });
                alert('–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞!');
                showLoginForm('user');
            } catch (error) {
                alert('–û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏: ' + error.message);
            }
        }

        async function loginUser() {
            const email = document.getElementById('userEmail').value;
            const password = document.getElementById('userPassword').value;

            try {
                await auth.signInWithEmailAndPassword(email, password);
                document.getElementById('userLoginForm').style.display = 'none';
                document.getElementById('userPanel').style.display = 'block';
                loadUserLicenses();
            } catch (error) {
                alert('–û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞: ' + error.message);
            }
        }

        function logout() {
            auth.signOut();
            location.reload();
        }

        // –û—Å—Ç–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (generateUserKey, loadUsers, checkKey) –æ—Å—Ç–∞—é—Ç—Å—è –∫–∞–∫ –±—ã–ª–∏
        // –î–æ–±–∞–≤—å –∏—Ö –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –∫–æ–¥–∞

        function generateUserKey() {
            const name = document.getElementById('userName').value;
            const email = document.getElementById('userEmail').value;
            const telegram = document.getElementById('userTelegram').value;
            const days = parseInt(document.getElementById('daysValid').value);

            if (!name || !email) {
                alert('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –∏–º—è –∏ email!');
                return;
            }

            const key = "ARMFFSOFT-" + Math.random().toString(36).substr(2, 6).toUpperCase() + "-" +
                       Math.random().toString(36).substr(2, 6).toUpperCase() + "-" +
                       Math.random().toString(36).substr(2, 6).toUpperCase();

            const created = new Date();
            const expires = new Date();
            expires.setDate(expires.getDate() + days);

            db.collection("licenses").add({
                name: name,
                email: email,
                telegram: telegram,
                key: key,
                created: firebase.firestore.Timestamp.fromDate(created),
                expires: firebase.firestore.Timestamp.fromDate(expires),
                status: "active",
                createdBy: "admin"
            })
            .then(() => {
                document.getElementById('generatedKey').textContent = key;
                document.getElementById('keyDetails').innerHTML = `
                    <p><strong>–ö–ª–∏–µ–Ω—Ç:</strong> ${name}</p>
                    <p><strong>Email:</strong> ${email}</p>
                    <p><strong>–°—Ä–æ–∫:</strong> ${days} –¥–Ω–µ–π</p>
                    <p><strong>–ò—Å—Ç–µ–∫–∞–µ—Ç:</strong> ${expires.toLocaleDateString('ru-RU')}</p>
                `;
                document.getElementById('keyResult').style.display = 'block';
                loadUsers();
            })
            .catch(error => {
                alert('–û—à–∏–±–∫–∞: ' + error.message);
            });
        }

        function loadUsers() {
            db.collection("licenses").orderBy("created", "desc").get().then((querySnapshot) => {
                const container = document.getElementById('usersList');
                container.innerHTML = '';
                querySnapshot.forEach((doc) => {
                    const user = doc.data();
                    const expires = user.expires.toDate();
                    const now = new Date();
                    const isActive = now < expires && user.status === "active";
                    
                    const userCard = document.createElement('div');
                    userCard.style.background = 'rgba(255,255,255,0.05)';
                    userCard.style.padding = '15px';
                    userCard.style.borderRadius = '8px';
                    userCard.innerHTML = `
                        <strong>${user.name}</strong><br>
                        ${user.email}<br>
                        <code>${user.key}</code><br>
                        <span style="color: ${isActive ? '#27ae60' : '#e74c3c'}">
                            ${isActive ? '‚úÖ –ê–∫—Ç–∏–≤–µ–Ω' : '‚ùå –ò—Å—Ç–µ–∫'} –¥–æ ${expires.toLocaleDateString('ru-RU')}
                        </span>
                    `;
                    container.appendChild(userCard);
                });
            });
        }

        function loadUserLicenses() {
            const user = auth.currentUser;
            if (user) {
                db.collection("licenses").where("email", "==", user.email).get().then((querySnapshot) => {
                    const container = document.getElementById('userLicenses');
                    container.innerHTML = '';
                    
                    if (querySnapshot.empty) {
                        container.innerHTML = '<p>–£ –≤–∞—Å –Ω–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –ª–∏—Ü–µ–Ω–∑–∏–π</p>';
                    } else {
                        querySnapshot.forEach((doc) => {
                            const license = doc.data();
                            const expires = license.expires.toDate();
                            const now = new Date();
                            const isActive = now < expires && license.status === "active";
                            
                            container.innerHTML += `
                                <div style="background: rgba(255,255,255,0.05); padding: 15px; border-radius: 8px; margin: 10px 0;">
                                    <strong>–õ–∏—Ü–µ–Ω–∑–∏–æ–Ω–Ω—ã–π –∫–ª—é—á:</strong><br>
                                    <code style="font-size: 1.2em;">${license.key}</code><br>
                                    <span style="color: ${isActive ? '#27ae60' : '#e74c3c'}">
                                        ${isActive ? '‚úÖ –ê–∫—Ç–∏–≤–Ω–∞' : '‚ùå –ò—Å—Ç–µ–∫–ª–∞'} –¥–æ ${expires.toLocaleDateString('ru-RU')}
                                    </span>
                                </div>
                            `;
                        });
                    }
                });
            }
        }

        function checkKey() {
            const key = document.getElementById('checkKeyInput').value.trim();
            const resultDiv = document.getElementById('checkResult');
            
            db.collection("licenses").where("key", "==", key).get()
            .then((querySnapshot) => {
                if (querySnapshot.empty) {
                    resultDiv.innerHTML = '<div style="color: #e74c3c;">‚ùå –õ–∏—Ü–µ–Ω–∑–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω–∞</div>';
                } else {
                    querySnapshot.forEach((doc) => {
                        const license = doc.data();
                        const now = new Date();
                        const expires = license.expires.toDate();
                        const isValid = now < expires && license.status === "active";
                        
                        if (isValid) {
                            resultDiv.innerHTML = `
                                <div style="color: #27ae60;">
                                    <h4>‚úÖ –õ–∏—Ü–µ–Ω–∑–∏—è –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–∞</h4>
                                    <p><strong>–í–ª–∞–¥–µ–ª–µ—Ü:</strong> ${license.name}</p>
                                    <p><strong>–ò—Å—Ç–µ–∫–∞–µ—Ç:</strong> ${expires.toLocaleDateString('ru-RU')}</p>
                                </div>
                            `;
                        } else {
                            resultDiv.innerHTML = `
                                <div style="color: #e74c3c;">
                                    <h4>‚ùå –õ–∏—Ü–µ–Ω–∑–∏—è –Ω–µ–∞–∫—Ç–∏–≤–Ω–∞</h4>
                                    <p><strong>–í–ª–∞–¥–µ–ª–µ—Ü:</strong> ${license.name}</p>
                                    <p><strong>–ò—Å—Ç–µ–∫–ª–∞:</strong> ${expires.toLocaleDateString('ru-RU')}</p>
                                </div>
                            `;
                        }
                    });
                }
            });
        }

        function copyKey() {
            const key = document.getElementById('generatedKey').textContent;
            navigator.clipboard.writeText(key).then(() => {
                alert('–ö–ª—é—á —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω!');
            });
        }

        // –ê–≤—Ç–æ–≤—Ö–æ–¥ –¥–ª—è –∞–¥–º–∏–Ω–∞ (–¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞)
        document.getElementById('adminEmail').value = VIP_ADMIN.email;
        document.getElementById('adminPassword').value = VIP_ADMIN.password;
    </script>
</body>
</html>
